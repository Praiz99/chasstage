<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wckj.chasstage.modules.rygj.dao.ChasRygjSnapMapper">
  <resultMap id="BaseResultMap" type="com.wckj.chasstage.modules.rygj.entity.ChasRygjSnap">
    <id column="ID" jdbcType="VARCHAR" property="id" />
    <result column="ISDEL" jdbcType="INTEGER" property="isdel" />
    <result column="DATA_FLAG" jdbcType="CHAR" property="dataflag" />
    <result column="LRR_SFZH" jdbcType="VARCHAR" property="lrrSfzh" />
    <result column="LRSJ" jdbcType="TIMESTAMP" property="lrsj" />
    <result column="XGR_SFZH" jdbcType="VARCHAR" property="xgrSfzh" />
    <result column="XGSJ" jdbcType="TIMESTAMP" property="xgsj" />
    <result column="BAQID" jdbcType="VARCHAR" property="baqid" />
    <result column="BAQMC" jdbcType="VARCHAR" property="baqmc" />
    <result column="RYID" jdbcType="VARCHAR" property="ryid" />
    <result column="WDBH" jdbcType="VARCHAR" property="wdbh" />
    <result column="QYID" jdbcType="VARCHAR" property="qyid" />
    <result column="XM" jdbcType="VARCHAR" property="xm" />
    <result column="KSSJ" jdbcType="TIMESTAMP" property="kssj" />
    <result column="JSSJ" jdbcType="TIMESTAMP" property="jssj" />
    <result column="FZRXM" jdbcType="VARCHAR" property="fzrxm" />
    <result column="HDNR" jdbcType="VARCHAR" property="hdnr" />
    <result column="SBID" jdbcType="VARCHAR" property="sbid" />
    <result column="QYMC" jdbcType="VARCHAR" property="qymc" />
    <result column="RYBH" jdbcType="VARCHAR" property="rybh" />
    <result column="BZ" jdbcType="VARCHAR" property="bz"/>
    <result column="rylx" jdbcType="VARCHAR" property="rylx"/>
    <result column="tsqt" jdbcType="VARCHAR" property="tsqt"/>

  </resultMap>

    <resultMap id="BaseResultMapExt" type="com.wckj.chasstage.modules.rygj.entity.ChasRygjSnapExt">
        <result column="zpid" jdbcType="VARCHAR" property="zpid"/>
        <result column="xb" jdbcType="VARCHAR" property="xb"/>
        <result column="zjlx" jdbcType="VARCHAR" property="zjlx"/>
        <result column="ry_sfzh" jdbcType="VARCHAR" property="rySfzh"/>
        <result column="csrq" jdbcType="TIMESTAMP" property="csrq"/>
        <result column="hjd_xzqh" jdbcType="VARCHAR" property="hjdXzqh"/>
        <result column="r_rssj" jdbcType="TIMESTAMP" property="rrssj"/>
        <result column="ry_zaybh" jdbcType="VARCHAR" property="ryZaybh"/>
        <result column="dafs" jdbcType="VARCHAR" property="dafs"/>
        <result column="sftsqt" jdbcType="TIMESTAMP" property="sftsqt"/>
        <result column="ry_rylx" jdbcType="TIMESTAMP" property="ryRylx"/>
    </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    delete from chas_yw_rygj_snap
    where ID = #{id,jdbcType=VARCHAR}
  </delete>
    <delete id="deleteByRybh" parameterType="java.lang.String">
    delete from chas_yw_rygj_snap
    where RYBH = #{rybh,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.wckj.chasstage.modules.rygj.entity.ChasRygjSnap">
    insert into chas_yw_rygj_snap (ID, ISDEL, DATA_FLAG,
      LRR_SFZH, LRSJ, XGR_SFZH, 
      XGSJ, BAQID, BAQMC, 
      RYID, WDBH, QYID, XM, 
      KSSJ, JSSJ, FZRXM, 
      HDNR, SBID, QYMC, RYBH,BZ,rylx
      )
    values (#{id,jdbcType=VARCHAR}, #{isdel,jdbcType=INTEGER}, #{dataflag,jdbcType=CHAR}, 
      #{lrrSfzh,jdbcType=VARCHAR}, #{lrsj,jdbcType=TIMESTAMP}, #{xgrSfzh,jdbcType=VARCHAR}, 
      #{xgsj,jdbcType=TIMESTAMP}, #{baqid,jdbcType=VARCHAR}, #{baqmc,jdbcType=VARCHAR}, 
      #{ryid,jdbcType=VARCHAR}, #{wdbh,jdbcType=VARCHAR}, #{qyid,jdbcType=VARCHAR}, #{xm,jdbcType=VARCHAR}, 
      #{kssj,jdbcType=TIMESTAMP}, #{jssj,jdbcType=TIMESTAMP}, #{fzrxm,jdbcType=VARCHAR}, 
      #{hdnr,jdbcType=VARCHAR}, #{sbid,jdbcType=VARCHAR}, #{qymc,jdbcType=VARCHAR}, #{rybh,jdbcType=VARCHAR}
      ,#{bz,jdbcType=VARCHAR},#{rylx,jdbcType=VARCHAR}
      )
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.wckj.chasstage.modules.rygj.entity.ChasRygjSnap">
    update chas_yw_rygj_snap
    set ISDEL = #{isdel,jdbcType=INTEGER},
      DATA_FLAG = #{dataflag,jdbcType=CHAR},
      LRR_SFZH = #{lrrSfzh,jdbcType=VARCHAR},
      LRSJ = #{lrsj,jdbcType=TIMESTAMP},
      XGR_SFZH = #{xgrSfzh,jdbcType=VARCHAR},
      XGSJ = date_trunc('second', now()),
      BAQID = #{baqid,jdbcType=VARCHAR},
      BAQMC = #{baqmc,jdbcType=VARCHAR},
      RYID = #{ryid,jdbcType=VARCHAR},
      WDBH = #{wdbh,jdbcType=VARCHAR},
      QYID = #{qyid,jdbcType=VARCHAR},
      XM = #{xm,jdbcType=VARCHAR},
      KSSJ = #{kssj,jdbcType=TIMESTAMP},
      JSSJ = #{jssj,jdbcType=TIMESTAMP},
      FZRXM = #{fzrxm,jdbcType=VARCHAR},
      HDNR = #{hdnr,jdbcType=VARCHAR},
      SBID = #{sbid,jdbcType=VARCHAR},
      QYMC = #{qymc,jdbcType=VARCHAR},
      RYBH = #{rybh,jdbcType=VARCHAR},
      BZ = #{bz,jdbcType=VARCHAR},
      rylx = #{rylx,jdbcType=VARCHAR}
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    select ID, ISDEL, DATA_FLAG, LRR_SFZH, LRSJ, XGR_SFZH, XGSJ, BAQID, BAQMC, RYID, 
    WDBH, QYID, XM, KSSJ, JSSJ, FZRXM, HDNR, SBID, QYMC, RYBH, BZ,rylx
    from chas_yw_rygj_snap
    where isdel = 0 and ID = #{id,jdbcType=VARCHAR}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">

    select ID, ISDEL, DATA_FLAG, LRR_SFZH, LRSJ, XGR_SFZH, XGSJ, BAQID, BAQMC, RYID, 
    WDBH, QYID, XM, KSSJ, JSSJ, FZRXM, HDNR, SBID, QYMC, RYBH, BZ,rylx
    from chas_yw_rygj_snap
     <where>
      1=1 and isdel = 0
      <if test="baqid != null and baqid !=''">
          and BAQID = '${baqid}' 
      </if>
      <if test="wdbh != null and wdbh !=''">
          and WDBH = '${wdbh}' 
      </if>
      <if test="xgrSfzh != null and xgrSfzh !=''">
          and XGRSFZH = '${xgrSfzh}' 
      </if>
      <if test="xm != null and xm !=''">
          and XM = '${xm}' 
      </if>
      <if test="qymc != null and qymc !=''">
          and QYMC = '${qymc}' 
      </if>
      <if test="qyid != null and qyid !=''">
          and QYID = '${qyid}' 
      </if>
      <if test="kssj != null and kssj !=''">
          and KSSJ = '${kssj}' 
      </if>
      <if test="jssj != null and jssj !=''">
          and JSSJ = '${jssj}'
      </if>
      <if test="ryid != null and ryid !=''">
          and RYID = '${ryid}' 
      </if>
      <if test="rybh != null and rybh !=''">
          and RYBH = '${rybh}' 
      </if>
     <if test="lrsjStart != '' and lrsjEnd != '' and lrsjStart != null and lrsjEnd != null">
         and lrsj >= to_timestamp('${lrsjStart}','yyyy-MM-dd hh24:mi:ss') and lrsj &lt;= to_timestamp('${lrsjEnd}','yyyy-MM-dd hh24:mi:ss')
     </if>
     <if test="kssjStart != '' and kssjStart != null">
         and kssj >= to_timestamp('${kssjStart}','yyyy-MM-dd hh24:mi:ss')
     </if>
     <if test="jssjEnd != '' and jssjEnd != null">
         and jssj &lt;= to_timestamp('${jssjEnd}','yyyy-MM-dd hh24:mi:ss')
     </if>
     <if test="gjsp != '' and gjsp != null">
         and kssj is not null and jssj is not null
     </if>
    </where>
  </select>
    <select id="getRywzxxBybaqid" resultMap="BaseResultMapExt">
        SELECT gj.*,ryxx.tsqt tsqt,ryxx.zpid,ryxx.xb,ryxx.zjlx,ryxx.ry_sfzh,ryxx.csrq,ryxx.hjd_xzqh,ryxx.r_rssj,ryxx.ry_zaybh,ryxx.dafs,ryxx.sftsqt,ryxx.rylx as  ry_rylx FROM chas_yw_rygj_snap gj INNER JOIN gg_baqryxx ryxx
        ON gj.id=ryxx.rybh where ryxx.ryzt='01'
        and ryxx.isdel=0 and gj.isdel=0 AND gj.baqid='${baqid}'
    </select>
    <select id="getMjwzxxBybaqid" resultMap="BaseResultMap">
        SELECT gj.* FROM chas_yw_rygj_snap gj INNER JOIN chas_yw_mjrq ryxx
        ON gj.id=ryxx.rybh where ryxx.zt='02'
        and ryxx.isdel=0 and gj.isdel=0 AND gj.baqid='${baqid}'
    </select>
    <select id="getFkwzxxBybaqid" resultMap="BaseResultMap">
        SELECT gj.* FROM chas_yw_rygj_snap gj INNER JOIN chas_yw_fkdj ryxx
        ON gj.id=ryxx.rybh where ryxx.zt='02'
        and ryxx.isdel=0 and gj.isdel=0 AND gj.baqid='${baqid}'
    </select>
    <select id="getDjjwzxxBybaqid" resultMap="BaseResultMap">
        SELECT gj.ID, gj.ISDEL, gj.DATA_FLAG, gj.LRR_SFZH, gj.LRSJ, gj.XGR_SFZH, gj.XGSJ, gj.BAQID, gj.BAQMC, gj.RYID,
        gj.WDBH, gj.QYID, gj.XM, gj.KSSJ, gj.JSSJ, gj.FZRXM, gj.HDNR, gj.SBID, gj.QYMC, concat('D',gj.RYBH) as RYBH ,
         ryxx.xkbhl as BZ,gj.rylx
        FROM chas_yw_rygj_snap gj INNER JOIN chas_yw_djj ryxx
        ON gj.id=ryxx.djjbh where ryxx.isdel=0 and gj.isdel=0 AND gj.baqid='${baqid}'
    </select>
</mapper>