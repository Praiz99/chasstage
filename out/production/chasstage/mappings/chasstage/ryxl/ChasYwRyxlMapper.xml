<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wckj.chasstage.modules.ryxl.dao.ChasYwRyxlMapper">
  <resultMap id="BaseResultMap" type="com.wckj.chasstage.modules.ryxl.entity.ChasYwRyxl">
    <result column="id" jdbcType="VARCHAR" property="id" />
    <result column="isdel" jdbcType="SMALLINT" property="isdel" />
    <result column="data_flag" jdbcType="VARCHAR" property="dataFlag" />
    <result column="lrr_sfzh" jdbcType="VARCHAR" property="lrrSfzh" />
    <result column="lrsj" jdbcType="TIMESTAMP" property="lrsj" />
    <result column="xgr_sfzh" jdbcType="VARCHAR" property="xgrSfzh" />
    <result column="xgsj" jdbcType="TIMESTAMP" property="xgsj" />
    <result column="baqid" jdbcType="VARCHAR" property="baqid" />
    <result column="baqmc" jdbcType="VARCHAR" property="baqmc" />
    <result column="wdbh_h" jdbcType="VARCHAR" property="wdbhH" />
    <result column="wdbh_l" jdbcType="VARCHAR" property="wdbhL" />
    <result column="rybh" jdbcType="VARCHAR" property="rybh" />
    <result column="ryxm" jdbcType="VARCHAR" property="ryxm" />
    <result column="bcsj" jdbcType="TIMESTAMP" property="bcsj" />
    <result column="ryxl" jdbcType="INTEGER" property="ryxl" />
    <result column="qyid" jdbcType="VARCHAR" property="qyid" />
    <result column="qymc" jdbcType="VARCHAR" property="qymc" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    update chas_yw_ryxl
    set isdel = 1,XGSJ = date_trunc('second', now())
    where ID = #{id,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.wckj.chasstage.modules.ryxl.entity.ChasYwRyxl">

    insert into chas_yw_ryxl (id, isdel, data_flag, 
      lrr_sfzh, lrsj, xgr_sfzh, 
      xgsj, baqid, baqmc, 
      wdbh_h, wdbh_l, rybh, 
      ryxm, bcsj, ryxl,qyid,qymc)
    values (#{id,jdbcType=VARCHAR}, #{isdel,jdbcType=SMALLINT}, #{dataFlag,jdbcType=VARCHAR}, 
      #{lrrSfzh,jdbcType=VARCHAR}, #{lrsj,jdbcType=TIMESTAMP}, #{xgrSfzh,jdbcType=VARCHAR}, 
      #{xgsj,jdbcType=TIMESTAMP}, #{baqid,jdbcType=VARCHAR}, #{baqmc,jdbcType=VARCHAR}, 
      #{wdbhH,jdbcType=VARCHAR}, #{wdbhL,jdbcType=VARCHAR}, #{rybh,jdbcType=VARCHAR}, 
      #{ryxm,jdbcType=VARCHAR}, #{bcsj,jdbcType=TIMESTAMP}, #{ryxl,jdbcType=INTEGER},
      #{qyid,jdbcType=VARCHAR},#{qymc,jdbcType=VARCHAR})
  </insert>

  <update id="updateByPrimaryKey" parameterType="com.wckj.chasstage.modules.ryxl.entity.ChasYwRyxl">
    update chas_yw_ryxl
    set isdel = #{isdel,jdbcType=SMALLINT},
    data_flag = #{dataFlag,jdbcType=VARCHAR},
    lrr_sfzh = #{lrrSfzh,jdbcType=VARCHAR},
    lrsj = #{lrsj,jdbcType=TIMESTAMP},
    xgr_sfzh = #{xgrSfzh,jdbcType=VARCHAR},
    xgsj = #{xgsj,jdbcType=TIMESTAMP},
    baqid = #{baqid,jdbcType=VARCHAR},
    baqmc = #{baqmc,jdbcType=VARCHAR},
    wdbh_h = #{wdbhH,jdbcType=VARCHAR},
    wdbh_l = #{wdbhL,jdbcType=VARCHAR},
    rybh = #{rybh,jdbcType=VARCHAR},
    ryxm = #{ryxm,jdbcType=TIMESTAMP},
    bcsj = #{bcsj,jdbcType=TIMESTAMP},
    ryxl = #{ryxl,jdbcType=INTEGER},
    qyid= #{qyid,jdbcType=VARCHAR},
    qymc = #{qymc,jdbcType=VARCHAR}
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    select id, isdel, data_flag, lrr_sfzh, lrsj, xgr_sfzh, xgsj, baqid, baqmc, wdbh_h,
    wdbh_l, rybh, ryxm, bcsj, ryxl,qyid,qymc
    from chas_yw_ryxl
    where id = #{id,jdbcType=VARCHAR}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    select id, isdel, data_flag, lrr_sfzh, lrsj, xgr_sfzh, xgsj, baqid, baqmc, wdbh_h, 
    wdbh_l, rybh, ryxm, bcsj, ryxl,qyid,qymc
    from chas_yw_ryxl
    <where>
      1=1 and ISDEL = 0
      <if test="baqid != null and baqid !=''">
        and BAQID = '${baqid}'
      </if>
      <if test="rybh != null and rybh !=''">
        and rybh = '${rybh}'
      </if>
      <if test="ryxm != null and ryxm !=''">
        and ryxm = '${ryxm}'
      </if>
      <if test="wdbhH != null and wdbhH != ''">
        and wdbh_h = '${wdbhH}'
      </if>
      <if test="wdbhL != null and wdbhL != ''">
        and wdbh_l = '${wdbhL}'
      </if>
    </where>
  </select>
  <select id="getLastestRyxlByRybh" resultMap="BaseResultMap" parameterType="string">
    select id, isdel, data_flag, lrr_sfzh, lrsj, xgr_sfzh, xgsj, baqid, baqmc, wdbh_h,
    wdbh_l, rybh, ryxm, bcsj, ryxl,qyid,qymc
    from chas_yw_ryxl where isdel=0 and rybh='${rybh}' order by bcsj desc limit 1 offset 0

  </select>
</mapper>